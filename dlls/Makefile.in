TOPSRCDIR = @top_srcdir@
TOPOBJDIR = ..
SRCDIR    = @srcdir@
VPATH     = @srcdir@

OPENGLFILES= \
	opengl32/libopengl32.@LIBEXT@

XFILES = \
	ddraw/libddraw.@LIBEXT@ \
	@OPENGLFILES@ \
	x11drv/libx11drv.@LIBEXT@

DLLFILES = \
	@XFILES@ \
	advapi32/libadvapi32.@LIBEXT@ \
	avifil32/libavifil32.@LIBEXT@ \
	comctl32/libcomctl32.@LIBEXT@ \
	commdlg/libcomdlg32.@LIBEXT@ \
	crtdll/libcrtdll.@LIBEXT@ \
	dciman32/libdciman32.@LIBEXT@ \
	dinput/libdinput.@LIBEXT@ \
	dplay/libdplay.@LIBEXT@ \
	dplayx/libdplayx.@LIBEXT@ \
	dsound/libdsound.@LIBEXT@ \
	gdi/libgdi32.@LIBEXT@ \
	icmp/libicmp.@LIBEXT@ \
	imagehlp/libimagehlp.@LIBEXT@ \
	imm32/libimm32.@LIBEXT@ \
	kernel/libkernel32.@LIBEXT@ \
	lzexpand/liblz32.@LIBEXT@ \
	mpr/libmpr.@LIBEXT@ \
	msacm/libmsacm32.@LIBEXT@ \
	msnet32/libmsnet32.@LIBEXT@ \
	msvideo/libmsvfw32.@LIBEXT@ \
	odbc32/libodbc32.@LIBEXT@ \
	ole32/libole32.@LIBEXT@ \
	oleaut32/liboleaut32.@LIBEXT@ \
	olecli/libolecli32.@LIBEXT@ \
	oledlg/liboledlg.@LIBEXT@ \
	olepro32/libolepro32.@LIBEXT@ \
	olesvr/libolesvr32.@LIBEXT@ \
	psapi/libpsapi.@LIBEXT@ \
	rasapi32/librasapi32.@LIBEXT@ \
	richedit/libriched32.@LIBEXT@ \
	rpcrt4/librpcrt4.@LIBEXT@ \
	serialui/libserialui.@LIBEXT@ \
	setupapi/libsetupapi.@LIBEXT@ \
	shell32/libshell32.@LIBEXT@ \
	shfolder/libshfolder.@LIBEXT@ \
	shlwapi/libshlwapi.@LIBEXT@ \
	tapi32/libtapi32.@LIBEXT@ \
	ttydrv/libttydrv.@LIBEXT@ \
	urlmon/liburlmon.@LIBEXT@ \
	user/libuser32.@LIBEXT@ \
	version/libversion.@LIBEXT@ \
	win32s/libw32skrnl.@LIBEXT@ \
	winaspi/libwnaspi32.@LIBEXT@ \
	wineps/libwineps.@LIBEXT@ \
	wininet/libwininet.@LIBEXT@ \
	winmm/joystick/libjoystick.drv.@LIBEXT@ \
	winmm/libwinmm.@LIBEXT@ \
	winmm/mcianim/libmcianim.drv.@LIBEXT@ \
	winmm/mciavi/libmciavi.drv.@LIBEXT@ \
	winmm/mcicda/libmcicda.drv.@LIBEXT@ \
	winmm/mciseq/libmciseq.drv.@LIBEXT@ \
	winmm/mciwave/libmciwave.drv.@LIBEXT@ \
	winmm/midimap/libmidimap.drv.@LIBEXT@ \
	winmm/wavemap/libmsacm.drv.@LIBEXT@ \
	winmm/wineoss/libwineoss.drv.@LIBEXT@ \
	winsock/libws2_32.@LIBEXT@ \
	winspool/libwinspool.drv.@LIBEXT@ \
	wow32/libwow32.@LIBEXT@ \
	wsock32/libwsock32.@LIBEXT@

# extra names for dlls containing multiple spec files
EXTRADLLNAMES = \
	avifile \
	comm \
	commdlg \
	compobj \
	ddeml \
	dispdib \
	display \
	gdi \
	kernel \
	keyboard \
	lzexpand \
	mmsystem \
	mouse \
	msacm \
	msvideo \
	ole2 \
	ole2conv \
	ole2disp \
	ole2nls \
	ole2prox \
	ole2thk \
	olecli \
	olesvr \
	rasapi16 \
	setupx \
	shell \
	sound \
	storage \
	stress \
	system \
	toolhelp \
	typelib \
	user \
	ver \
	w32sys \
	win32s16 \
	win87em \
	winaspi \
	windebug \
	wineps16 \
	wing \
	winsock \
	wprocs

SUBDIRS = \
	advapi32 \
	avifil32 \
	comctl32 \
	commdlg \
	crtdll \
	dciman32 \
	ddraw \
	dinput \
	dplay \
	dplayx \
	dsound \
	gdi \
	icmp \
	imagehlp \
	imm32 \
	kernel \
	lzexpand \
	mpr \
	msacm \
	msnet32 \
	msvideo \
	odbc32 \
	ole32 \
	oleaut32 \
	olecli \
	oledlg \
	olepro32 \
	olesvr \
	opengl32 \
	psapi \
	rasapi32 \
	richedit \
	rpcrt4 \
	serialui \
	setupapi \
	shell32 \
	shfolder \
	shlwapi \
	tapi32 \
	ttydrv \
	urlmon \
	user \
	version \
	win32s \
	winaspi \
	wineps \
	wininet \
	winmm \
	winsock \
	winspool \
	wow32 \
	wsock32 \
	x11drv

@MAKE_RULES@

all: $(DLLS:%=lib%.@LIBEXT@) $(EXTRADLLNAMES:%=lib%.@LIBEXT@)

# Map library name to directory

libadvapi32.@LIBEXT@: advapi32/libadvapi32.@LIBEXT@
	$(RM) $@ && $(LN_S) advapi32/libadvapi32.@LIBEXT@ $@

libavifil32.@LIBEXT@ libavifile.@LIBEXT@: avifil32/libavifil32.@LIBEXT@
	$(RM) $@ && $(LN_S) avifil32/libavifil32.@LIBEXT@ $@

libcomctl32.@LIBEXT@: comctl32/libcomctl32.@LIBEXT@
	$(RM) $@ && $(LN_S) comctl32/libcomctl32.@LIBEXT@ $@

libcomdlg32.@LIBEXT@ libcommdlg.@LIBEXT@: commdlg/libcomdlg32.@LIBEXT@
	$(RM) $@ && $(LN_S) commdlg/libcomdlg32.@LIBEXT@ $@

libcrtdll.@LIBEXT@: crtdll/libcrtdll.@LIBEXT@
	$(RM) $@ && $(LN_S) crtdll/libcrtdll.@LIBEXT@ $@

libdciman32.@LIBEXT@: dciman32/libdciman32.@LIBEXT@
	$(RM) $@ && $(LN_S) dciman32/libdciman32.@LIBEXT@ $@

libddraw.@LIBEXT@: ddraw/libddraw.@LIBEXT@
	$(RM) $@ && $(LN_S) ddraw/libddraw.@LIBEXT@ $@

libdinput.@LIBEXT@: dinput/libdinput.@LIBEXT@
	$(RM) $@ && $(LN_S) dinput/libdinput.@LIBEXT@ $@

libdplay.@LIBEXT@: dplay/libdplay.@LIBEXT@
	$(RM) $@ && $(LN_S) dplay/libdplay.@LIBEXT@ $@

libdplayx.@LIBEXT@: dplayx/libdplayx.@LIBEXT@
	$(RM) $@ && $(LN_S) dplayx/libdplayx.@LIBEXT@ $@

libdsound.@LIBEXT@: dsound/libdsound.@LIBEXT@
	$(RM) $@ && $(LN_S) dsound/libdsound.@LIBEXT@ $@

libgdi32.@LIBEXT@ libdispdib.@LIBEXT@ libgdi.@LIBEXT@ libwing.@LIBEXT@: gdi/libgdi32.@LIBEXT@
	$(RM) $@ && $(LN_S) gdi/libgdi32.@LIBEXT@ $@

libicmp.@LIBEXT@: icmp/libicmp.@LIBEXT@
	$(RM) $@ && $(LN_S) icmp/libicmp.@LIBEXT@ $@

libimagehlp.@LIBEXT@: imagehlp/libimagehlp.@LIBEXT@
	$(RM) $@ && $(LN_S) imagehlp/libimagehlp.@LIBEXT@ $@

libimm32.@LIBEXT@: imm32/libimm32.@LIBEXT@
	$(RM) $@ && $(LN_S) imm32/libimm32.@LIBEXT@ $@

libjoystick.drv.@LIBEXT@: winmm/joystick/libjoystick.drv.@LIBEXT@
	$(RM) $@ && $(LN_S) winmm/joystick/libjoystick.drv.@LIBEXT@ $@

libkernel32.@LIBEXT@ libcomm.@LIBEXT@ libkernel.@LIBEXT@ libstress.@LIBEXT@ \
  libsystem.@LIBEXT@ libtoolhelp.@LIBEXT@ libwin87em.@LIBEXT@ libwindebug.@LIBEXT@ \
  libwprocs.@LIBEXT@: kernel/libkernel32.@LIBEXT@
	$(RM) $@ && $(LN_S) kernel/libkernel32.@LIBEXT@ $@

liblz32.@LIBEXT@ liblzexpand.@LIBEXT@: lzexpand/liblz32.@LIBEXT@
	$(RM) $@ && $(LN_S) lzexpand/liblz32.@LIBEXT@ $@

libmcianim.drv.@LIBEXT@: winmm/mcianim/libmcianim.drv.@LIBEXT@
	$(RM) $@ && $(LN_S) winmm/mcianim/libmcianim.drv.@LIBEXT@ $@

libmciavi.drv.@LIBEXT@: winmm/mciavi/libmciavi.drv.@LIBEXT@
	$(RM) $@ && $(LN_S) winmm/mciavi/libmciavi.drv.@LIBEXT@ $@

libmcicda.drv.@LIBEXT@: winmm/mcicda/libmcicda.drv.@LIBEXT@
	$(RM) $@ && $(LN_S) winmm/mcicda/libmcicda.drv.@LIBEXT@ $@

libmciseq.drv.@LIBEXT@: winmm/mciseq/libmciseq.drv.@LIBEXT@
	$(RM) $@ && $(LN_S) winmm/mciseq/libmciseq.drv.@LIBEXT@ $@

libmciwave.drv.@LIBEXT@: winmm/mciwave/libmciwave.drv.@LIBEXT@
	$(RM) $@ && $(LN_S) winmm/mciwave/libmciwave.drv.@LIBEXT@ $@

libmidimap.drv.@LIBEXT@: winmm/midimap/libmidimap.drv.@LIBEXT@
	$(RM) $@ && $(LN_S) winmm/midimap/libmidimap.drv.@LIBEXT@ $@

libmpr.@LIBEXT@: mpr/libmpr.@LIBEXT@
	$(RM) $@ && $(LN_S) mpr/libmpr.@LIBEXT@ $@

libmsacm.drv.@LIBEXT@: winmm/wavemap/libmsacm.drv.@LIBEXT@
	$(RM) $@ && $(LN_S) winmm/wavemap/libmsacm.drv.@LIBEXT@ $@

libmsacm32.@LIBEXT@ libmsacm.@LIBEXT@: msacm/libmsacm32.@LIBEXT@
	$(RM) $@ && $(LN_S) msacm/libmsacm32.@LIBEXT@ $@

libmsnet32.@LIBEXT@: msnet32/libmsnet32.@LIBEXT@
	$(RM) $@ && $(LN_S) msnet32/libmsnet32.@LIBEXT@ $@

libmsvfw32.@LIBEXT@ libmsvideo.@LIBEXT@: msvideo/libmsvfw32.@LIBEXT@
	$(RM) $@ && $(LN_S) msvideo/libmsvfw32.@LIBEXT@ $@

libodbc32.@LIBEXT@: odbc32/libodbc32.@LIBEXT@
	$(RM) $@ && $(LN_S) odbc32/libodbc32.@LIBEXT@ $@

libole32.@LIBEXT@ libcompobj.@LIBEXT@ libole2.@LIBEXT@ libole2conv.@LIBEXT@ \
  libole2nls.@LIBEXT@ libole2prox.@LIBEXT@ libole2thk.@LIBEXT@ libstorage.@LIBEXT@: ole32/libole32.@LIBEXT@
	$(RM) $@ && $(LN_S) ole32/libole32.@LIBEXT@ $@

liboleaut32.@LIBEXT@ libole2disp.@LIBEXT@ libtypelib.@LIBEXT@: oleaut32/liboleaut32.@LIBEXT@
	$(RM) $@ && $(LN_S) oleaut32/liboleaut32.@LIBEXT@ $@

libolecli32.@LIBEXT@ libolecli.@LIBEXT@: olecli/libolecli32.@LIBEXT@
	$(RM) $@ && $(LN_S) olecli/libolecli32.@LIBEXT@ $@

liboledlg.@LIBEXT@: oledlg/liboledlg.@LIBEXT@
	$(RM) $@ && $(LN_S) oledlg/liboledlg.@LIBEXT@ $@

libolepro32.@LIBEXT@: olepro32/libolepro32.@LIBEXT@
	$(RM) $@ && $(LN_S) olepro32/libolepro32.@LIBEXT@ $@

libolesvr32.@LIBEXT@ libolesvr.@LIBEXT@: olesvr/libolesvr32.@LIBEXT@
	$(RM) $@ && $(LN_S) olesvr/libolesvr32.@LIBEXT@ $@

libopengl32.@LIBEXT@: opengl32/libopengl32.@LIBEXT@
	$(RM) $@ && $(LN_S) opengl32/libopengl32.@LIBEXT@ $@

libpsapi.@LIBEXT@: psapi/libpsapi.@LIBEXT@
	$(RM) $@ && $(LN_S) psapi/libpsapi.@LIBEXT@ $@

librasapi32.@LIBEXT@ librasapi16.@LIBEXT@: rasapi32/librasapi32.@LIBEXT@
	$(RM) $@ && $(LN_S) rasapi32/librasapi32.@LIBEXT@ $@

libriched32.@LIBEXT@: richedit/libriched32.@LIBEXT@
	$(RM) $@ && $(LN_S) richedit/libriched32.@LIBEXT@ $@

librpcrt4.@LIBEXT@: rpcrt4/librpcrt4.@LIBEXT@
	$(RM) $@ && $(LN_S) rpcrt4/librpcrt4.@LIBEXT@ $@

libserialui.@LIBEXT@: serialui/libserialui.@LIBEXT@
	$(RM) $@ && $(LN_S) serialui/libserialui.@LIBEXT@ $@

libsetupapi.@LIBEXT@ libsetupx.@LIBEXT@: setupapi/libsetupapi.@LIBEXT@
	$(RM) $@ && $(LN_S) setupapi/libsetupapi.@LIBEXT@ $@

libshell32.@LIBEXT@ libshell.@LIBEXT@: shell32/libshell32.@LIBEXT@
	$(RM) $@ && $(LN_S) shell32/libshell32.@LIBEXT@ $@

libshfolder.@LIBEXT@: shfolder/libshfolder.@LIBEXT@
	$(RM) $@ && $(LN_S) shfolder/libshfolder.@LIBEXT@ $@

libshlwapi.@LIBEXT@: shlwapi/libshlwapi.@LIBEXT@
	$(RM) $@ && $(LN_S) shlwapi/libshlwapi.@LIBEXT@ $@

libtapi32.@LIBEXT@: tapi32/libtapi32.@LIBEXT@
	$(RM) $@ && $(LN_S) tapi32/libtapi32.@LIBEXT@ $@

libttydrv.@LIBEXT@: ttydrv/libttydrv.@LIBEXT@
	$(RM) $@ && $(LN_S) ttydrv/libttydrv.@LIBEXT@ $@

liburlmon.@LIBEXT@: urlmon/liburlmon.@LIBEXT@
	$(RM) $@ && $(LN_S) urlmon/liburlmon.@LIBEXT@ $@

libuser32.@LIBEXT@ libddeml.@LIBEXT@ libdisplay.@LIBEXT@ libkeyboard.@LIBEXT@ \
  libmouse.@LIBEXT@ libuser.@LIBEXT@: user/libuser32.@LIBEXT@
	$(RM) $@ && $(LN_S) user/libuser32.@LIBEXT@ $@

libversion.@LIBEXT@ libver.@LIBEXT@: version/libversion.@LIBEXT@
	$(RM) $@ && $(LN_S) version/libversion.@LIBEXT@ $@

libw32skrnl.@LIBEXT@ libw32sys.@LIBEXT@ libwin32s16.@LIBEXT@: win32s/libw32skrnl.@LIBEXT@
	$(RM) $@ && $(LN_S) win32s/libw32skrnl.@LIBEXT@ $@

libwineoss.drv.@LIBEXT@: winmm/wineoss/libwineoss.drv.@LIBEXT@
	$(RM) $@ && $(LN_S) winmm/wineoss/libwineoss.drv.@LIBEXT@ $@

libwineps.@LIBEXT@ libwineps16.@LIBEXT@: wineps/libwineps.@LIBEXT@
	$(RM) $@ && $(LN_S) wineps/libwineps.@LIBEXT@ $@

libwininet.@LIBEXT@: wininet/libwininet.@LIBEXT@
	$(RM) $@ && $(LN_S) wininet/libwininet.@LIBEXT@ $@

libwinmm.@LIBEXT@ libmmsystem.@LIBEXT@ libsound.@LIBEXT@: winmm/libwinmm.@LIBEXT@
	$(RM) $@ && $(LN_S) winmm/libwinmm.@LIBEXT@ $@

libwinspool.drv.@LIBEXT@: winspool/libwinspool.drv.@LIBEXT@
	$(RM) $@ && $(LN_S) winspool/libwinspool.drv.@LIBEXT@ $@

libwnaspi32.@LIBEXT@ libwinaspi.@LIBEXT@: winaspi/libwnaspi32.@LIBEXT@
	$(RM) $@ && $(LN_S) winaspi/libwnaspi32.@LIBEXT@ $@

libwow32.@LIBEXT@: wow32/libwow32.@LIBEXT@
	$(RM) $@ && $(LN_S) wow32/libwow32.@LIBEXT@ $@

libws2_32.@LIBEXT@ libwinsock.@LIBEXT@: winsock/libws2_32.@LIBEXT@
	$(RM) $@ && $(LN_S) winsock/libws2_32.@LIBEXT@ $@

libwsock32.@LIBEXT@: wsock32/libwsock32.@LIBEXT@
	$(RM) $@ && $(LN_S) wsock32/libwsock32.@LIBEXT@ $@

libx11drv.@LIBEXT@: x11drv/libx11drv.@LIBEXT@
	$(RM) $@ && $(LN_S) x11drv/libx11drv.@LIBEXT@ $@

# Inter-dll dependencies (only necessary for .so)

avifil32/libavifil32.so: libmsvfw32.so libkernel32.so
comctl32/libcomctl32.so: libuser32.so libgdi32.so
commdlg/libcomdlg32.so: libshell32.so libshlwapi.so libcomctl32.so libuser32.so libwinspool.drv.so libgdi32.so libkernel32.so
crtdll/libcrtdll.so: libkernel32.so
ddraw/libddraw.so: libole32.so libuser32.so libx11drv.so libgdi32.so libkernel32.so
dinput/libdinput.so: libuser32.so libkernel32.so
dplay/libdplay.so: libdplayx.so
dplayx/libdplayx.so: libole32.so libadvapi32.so libkernel32.so
dsound/libdsound.so: libwinmm.so libkernel32.so
gdi/libgdi32.so: libkernel32.so
msacm/libmsacm32.so: libwinmm.so
msvideo/libmsvfw32.so: libwinmm.so libuser32.so libgdi32.so libkernel32.so
ole32/libole32.so: libadvapi32.so libuser32.so libgdi32.so librpcrt4.so libkernel32.so
oleaut32/liboleaut32.so: libole32.so libgdi32.so libkernel32.so
olecli/libolecli32.so: libole32.so libolesvr32.so libgdi32.so
olepro32/libolepro32.so: liboleaut32.so
opengl32/libopengl32.so: libx11drv.so
richedit/libriched32.so: libuser32.so
serialui/libserialui.so: libuser32.so
shell32/libshell32.so: libole32.so libshlwapi.so libcomctl32.so libadvapi32.so libuser32.so libgdi32.so libkernel32.so
shfolder/libshfolder.so: libshell32.so
shlwapi/libshlwapi.so: libadvapi32.so libuser32.so libkernel32.so
ttydrv/libttydrv.so: libuser32.so libgdi32.so libkernel32.so
urlmon/liburlmon.so: libole32.so
user/libuser32.so: libgdi32.so libkernel32.so
version/libversion.so: liblz32.so libkernel32.so
win32s/libw32skrnl.so: libkernel32.so
wineps/libwineps.so: libgdi32.so
winmm/joystick/libjoystick.drv.so: libwinmm.so libuser32.so
winmm/libwinmm.so: libuser32.so
winmm/mcianim/libmcianim.drv.so: libwinmm.so libuser32.so libkernel32.so
winmm/mciavi/libmciavi.drv.so: libwinmm.so libuser32.so libkernel32.so
winmm/mcicda/libmcicda.drv.so: libwinmm.so libuser32.so libkernel32.so
winmm/mciseq/libmciseq.drv.so: libwinmm.so libuser32.so libkernel32.so
winmm/mciwave/libmciwave.drv.so: libwinmm.so libuser32.so libkernel32.so
winmm/midimap/libmidimap.drv.so: libwinmm.so libuser32.so libkernel32.so
winmm/wavemap/libmsacm.drv.so: libwinmm.so libuser32.so libkernel32.so
winmm/wineoss/libwineoss.drv.so: libwinmm.so libuser32.so libkernel32.so
winsock/libws2_32.so: libuser32.so
winspool/libwinspool.drv.so: libgdi32.so
wow32/libwow32.so: libkernel32.so
wsock32/libwsock32.so: libws2_32.so
x11drv/libx11drv.so: libuser32.so libgdi32.so libkernel32.so

$(DLLFILES): dummy
	@cd `dirname $@` && $(MAKE)

$(DLLFILES:%=%_install_): dummy
	@cd `dirname $@` && $(MAKE) install

$(DLLFILES:%=%_uninstall_): dummy
	@cd `dirname $@` && $(MAKE) uninstall

$(DLLFILES:%=%_checklink_): dummy
	@cd `dirname $@` && $(MAKE) checklink

install:: $(DLLFILES:%=%_install_)

uninstall:: $(DLLFILES:%=%_uninstall_)

checklink:: $(DLLFILES:%=%_checklink_)
